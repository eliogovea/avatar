<html>
<head>
	<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="/static/css/profile.css" rel="stylesheet" type="text/css">
	<title>Avatar UPR</title>
</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/admin/pending">Pendientes</a>
                    </li>
                    <li>
                        <a href="/admin/approved">Aprobados</a>
                    </li>
                    <li>
                        <a href="/personal">Mi Perfil</a>
                    </li>
                </ul>
                 <div class="pull-right">
                    <ul class="nav navbar-nav">
                        <li>
                            <a href="/logout">Salir</a>
                     </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <div>
        {{range .Files}}
        <div>
            <li>
            <img id="{{.Username}}" src="{{.Name}}" width="320" height="320">
            </li> 
            <div>
                <ul>
                    <button class="positive" onclick="accept({{.Username}})">Aceptar</button>
                </ul>
                <ul>
                    <button class="negative" onclick="deny({{.Username}})">Denegar</button>
                </ul>
            </div>
            <b class="username">{{.Username}}</b>
        </div>
        {{end}}
    </div>
</body>

<script>
function accept(username) {
    var request = new XMLHttpRequest();
    request.open('GET', '/api/approve/' + username, true);
    request.onload = function() {
        if (this.status == 200) {
            document.getElementById(username).src = "/static/img/approved.jpeg";
            
        } else {
            alert("!!! internal error !!!")
        }
    }
    request.send();
}

function deny(username) {
    var request = new XMLHttpRequest();
    request.open('GET', '/api/deny/pending/' + username, true);
    request.onload = function() {
        if (this.status == 200) {
            document.getElementById(username).src = "/static/img/denied.jpeg";
            
        } else {
            alert("!!! internal error !!!")
        }
    }
    request.send();
    // TODO
}

</script>

</html>
